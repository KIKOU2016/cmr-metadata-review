require 'test_helper'

class ColorTest < ActiveSupport::TestCase

  describe "values" do
    it "fills in datable values if values are missing" do
      record = Record.find_by id: 1
      #This is to test the safety method of generating JSON for a datable object with no data.
      #should be unreachable due to initialization in the get_[data_type] methods
      #but still wanted to keep and test directly
      colors = Color.new(record: record)
      values = colors.values
      assert_equal(values["ShortName"], "")
    end
  end

  describe "update_partial_values" do
    it "adds to the existing counts without deleting them" do
      new_color_hash = {"Temporal/PrecisionOfSeconds"=>"blue"}
      (Record.find_by id: 1).get_colors.update_partial_values(new_color_hash)
      assert_equal(4, (Record.find_by id: 1).get_colors.blue_count)

      new_color_hash = {"ProcessingCenter"=>"blue"}
      (Record.find_by id: 1).get_colors.update_partial_values(new_color_hash)
      assert_equal(5, (Record.find_by id: 1).get_colors.blue_count)
    end
  end

  describe "update_color_counts" do 
    it "changes the indexed color counts based on values hash" do
      new_color_hash = {"xmlns:xsi"=>"", "xsi:noNamespaceSchemaLocation"=>"", "ShortName"=>"blue", "VersionId"=>"blue", "InsertTime"=>"yellow", "LastUpdate"=>"green", "LongName"=>"red", "DataSetId"=>"yellow", "Description"=>"", "Orderable"=>"blue", "Visible"=>"", "ProcessingCenter"=>"", "ProcessingLevelId"=>"", "ProcessingLevelDescription"=>"", "ArchiveCenter"=>"", "Temporal/TimeType"=>"", "Temporal/DateType"=>"", "Temporal/TemporalRangeType"=>"", "Temporal/PrecisionOfSeconds"=>"", "Temporal/EndsAtPresentFlag"=>"", "Temporal/RangeDateTime/BeginningDateTime"=>"", "Temporal/RangeDateTime/EndingDateTime"=>"", "Contacts/Contact/Role"=>"", "Contacts/Contact/OrganizationPhones/Phone/Number"=>"", "Contacts/Contact/OrganizationPhones/Phone/Type"=>"", "Contacts/Contact/OrganizationEmails/Email"=>"", "ScienceKeywords/ScienceKeyword/CategoryKeyword"=>"", "ScienceKeywords/ScienceKeyword/TopicKeyword"=>"", "ScienceKeywords/ScienceKeyword/TermKeyword"=>"", "ScienceKeywords/ScienceKeyword/VariableLevel1Keyword/Value"=>"", "Platforms/Platform/ShortName"=>"", "Platforms/Platform/LongName"=>"", "Platforms/Platform/Type"=>"", "Platforms/Platform/Instruments/Instrument/ShortName"=>"", "Platforms/Platform/Instruments/Instrument/LongName"=>"", "Platforms/Platform/Instruments/Instrument/Sensors/Sensor/ShortName"=>"", "Platforms/Platform/Instruments/Instrument/OperationModes/OperationMode"=>"", "AdditionalAttributes/AdditionalAttribute0/Name"=>"", "AdditionalAttributes/AdditionalAttribute0/DataType"=>"", "AdditionalAttributes/AdditionalAttribute0/Description"=>"", "AdditionalAttributes/AdditionalAttribute1/Name"=>"", "AdditionalAttributes/AdditionalAttribute1/DataType"=>"", "AdditionalAttributes/AdditionalAttribute1/Description"=>"", "AdditionalAttributes/AdditionalAttribute2/Name"=>"", "AdditionalAttributes/AdditionalAttribute2/DataType"=>"", "AdditionalAttributes/AdditionalAttribute2/Description"=>"", "AdditionalAttributes/AdditionalAttribute3/Name"=>"", "AdditionalAttributes/AdditionalAttribute3/DataType"=>"", "AdditionalAttributes/AdditionalAttribute3/Description"=>"", "AdditionalAttributes/AdditionalAttribute4/Name"=>"", "AdditionalAttributes/AdditionalAttribute4/DataType"=>"", "AdditionalAttributes/AdditionalAttribute4/Description"=>"", "AdditionalAttributes/AdditionalAttribute5/Name"=>"", "AdditionalAttributes/AdditionalAttribute5/DataType"=>"", "AdditionalAttributes/AdditionalAttribute5/Description"=>"", "AdditionalAttributes/AdditionalAttribute6/Name"=>"", "AdditionalAttributes/AdditionalAttribute6/DataType"=>"", "AdditionalAttributes/AdditionalAttribute6/Description"=>"", "AdditionalAttributes/AdditionalAttribute7/Name"=>"", "AdditionalAttributes/AdditionalAttribute7/DataType"=>"", "AdditionalAttributes/AdditionalAttribute7/Description"=>"", "AdditionalAttributes/AdditionalAttribute8/Name"=>"", "AdditionalAttributes/AdditionalAttribute8/DataType"=>"", "AdditionalAttributes/AdditionalAttribute8/Description"=>"", "AdditionalAttributes/AdditionalAttribute9/Name"=>"", "AdditionalAttributes/AdditionalAttribute9/DataType"=>"", "AdditionalAttributes/AdditionalAttribute9/Description"=>"", "AdditionalAttributes/AdditionalAttribute10/Name"=>"", "AdditionalAttributes/AdditionalAttribute10/DataType"=>"", "AdditionalAttributes/AdditionalAttribute10/Description"=>"", "AdditionalAttributes/AdditionalAttribute11/Name"=>"", "AdditionalAttributes/AdditionalAttribute11/DataType"=>"", "AdditionalAttributes/AdditionalAttribute11/Description"=>"", "AdditionalAttributes/AdditionalAttribute12/Name"=>"", "AdditionalAttributes/AdditionalAttribute12/DataType"=>"", "AdditionalAttributes/AdditionalAttribute12/Description"=>"", "AdditionalAttributes/AdditionalAttribute13/Name"=>"", "AdditionalAttributes/AdditionalAttribute13/DataType"=>"", "AdditionalAttributes/AdditionalAttribute13/Description"=>"", "AdditionalAttributes/AdditionalAttribute14/Name"=>"", "AdditionalAttributes/AdditionalAttribute14/DataType"=>"", "AdditionalAttributes/AdditionalAttribute14/Description"=>"", "AdditionalAttributes/AdditionalAttribute15/Name"=>"", "AdditionalAttributes/AdditionalAttribute15/DataType"=>"", "AdditionalAttributes/AdditionalAttribute15/Description"=>"", "AdditionalAttributes/AdditionalAttribute16/Name"=>"", "AdditionalAttributes/AdditionalAttribute16/DataType"=>"", "AdditionalAttributes/AdditionalAttribute16/Description"=>"", "AdditionalAttributes/AdditionalAttribute17/Name"=>"", "AdditionalAttributes/AdditionalAttribute17/DataType"=>"", "AdditionalAttributes/AdditionalAttribute17/Description"=>"", "AdditionalAttributes/AdditionalAttribute18/Name"=>"", "AdditionalAttributes/AdditionalAttribute18/DataType"=>"", "AdditionalAttributes/AdditionalAttribute18/Description"=>"", "AdditionalAttributes/AdditionalAttribute19/Name"=>"", "AdditionalAttributes/AdditionalAttribute19/DataType"=>"", "AdditionalAttributes/AdditionalAttribute19/Description"=>"", "AdditionalAttributes/AdditionalAttribute20/Name"=>"", "AdditionalAttributes/AdditionalAttribute20/DataType"=>"", "AdditionalAttributes/AdditionalAttribute20/Description"=>"", "AdditionalAttributes/AdditionalAttribute21/Name"=>"", "AdditionalAttributes/AdditionalAttribute21/DataType"=>"", "AdditionalAttributes/AdditionalAttribute21/Description"=>"", "AdditionalAttributes/AdditionalAttribute22/Name"=>"", "AdditionalAttributes/AdditionalAttribute22/DataType"=>"", "AdditionalAttributes/AdditionalAttribute22/Description"=>"", "AdditionalAttributes/AdditionalAttribute23/Name"=>"", "AdditionalAttributes/AdditionalAttribute23/DataType"=>"", "AdditionalAttributes/AdditionalAttribute23/Description"=>"", "AdditionalAttributes/AdditionalAttribute24/Name"=>"", "AdditionalAttributes/AdditionalAttribute24/DataType"=>"", "AdditionalAttributes/AdditionalAttribute24/Description"=>"", "AdditionalAttributes/AdditionalAttribute25/Name"=>"", "AdditionalAttributes/AdditionalAttribute25/DataType"=>"", "AdditionalAttributes/AdditionalAttribute25/Description"=>"", "AdditionalAttributes/AdditionalAttribute26/Name"=>"", "AdditionalAttributes/AdditionalAttribute26/DataType"=>"", "AdditionalAttributes/AdditionalAttribute26/Description"=>"", "AdditionalAttributes/AdditionalAttribute27/Name"=>"", "AdditionalAttributes/AdditionalAttribute27/DataType"=>"", "AdditionalAttributes/AdditionalAttribute27/Description"=>"", "AdditionalAttributes/AdditionalAttribute28/Name"=>"", "AdditionalAttributes/AdditionalAttribute28/DataType"=>"", "AdditionalAttributes/AdditionalAttribute28/Description"=>"", "AdditionalAttributes/AdditionalAttribute29/Name"=>"", "AdditionalAttributes/AdditionalAttribute29/DataType"=>"", "AdditionalAttributes/AdditionalAttribute29/Description"=>"", "AdditionalAttributes/AdditionalAttribute30/Name"=>"", "AdditionalAttributes/AdditionalAttribute30/DataType"=>"", "AdditionalAttributes/AdditionalAttribute30/Description"=>"", "AdditionalAttributes/AdditionalAttribute31/Name"=>"", "AdditionalAttributes/AdditionalAttribute31/DataType"=>"", "AdditionalAttributes/AdditionalAttribute31/Description"=>"", "AdditionalAttributes/AdditionalAttribute32/Name"=>"", "AdditionalAttributes/AdditionalAttribute32/DataType"=>"", "AdditionalAttributes/AdditionalAttribute32/Description"=>"", "AdditionalAttributes/AdditionalAttribute33/Name"=>"", "AdditionalAttributes/AdditionalAttribute33/DataType"=>"", "AdditionalAttributes/AdditionalAttribute33/Description"=>"", "AdditionalAttributes/AdditionalAttribute34/Name"=>"", "AdditionalAttributes/AdditionalAttribute34/DataType"=>"", "AdditionalAttributes/AdditionalAttribute34/Description"=>"", "AdditionalAttributes/AdditionalAttribute35/Name"=>"", "AdditionalAttributes/AdditionalAttribute35/DataType"=>"", "AdditionalAttributes/AdditionalAttribute35/Description"=>"", "AdditionalAttributes/AdditionalAttribute36/Name"=>"", "AdditionalAttributes/AdditionalAttribute36/DataType"=>"", "AdditionalAttributes/AdditionalAttribute36/Description"=>"", "AdditionalAttributes/AdditionalAttribute37/Name"=>"", "AdditionalAttributes/AdditionalAttribute37/DataType"=>"", "AdditionalAttributes/AdditionalAttribute37/Description"=>"", "AdditionalAttributes/AdditionalAttribute38/Name"=>"", "AdditionalAttributes/AdditionalAttribute38/DataType"=>"", "AdditionalAttributes/AdditionalAttribute38/Description"=>"", "AdditionalAttributes/AdditionalAttribute39/Name"=>"", "AdditionalAttributes/AdditionalAttribute39/DataType"=>"", "AdditionalAttributes/AdditionalAttribute39/Description"=>"", "AdditionalAttributes/AdditionalAttribute40/Name"=>"", "AdditionalAttributes/AdditionalAttribute40/DataType"=>"", "AdditionalAttributes/AdditionalAttribute40/Description"=>"", "Campaigns/Campaign0/ShortName"=>"", "Campaigns/Campaign1/ShortName"=>"", "Campaigns/Campaign2/ShortName"=>"", "Campaigns/Campaign3/ShortName"=>"", "Campaigns/Campaign4/ShortName"=>"", "Campaigns/Campaign5/ShortName"=>"", "Campaigns/Campaign6/ShortName"=>"", "Campaigns/Campaign7/ShortName"=>"", "Campaigns/Campaign8/ShortName"=>"", "Campaigns/Campaign9/ShortName"=>"", "Campaigns/Campaign10/ShortName"=>"", "Campaigns/Campaign11/ShortName"=>"", "OnlineAccessURLs/OnlineAccessURL/URL"=>"", "OnlineAccessURLs/OnlineAccessURL/URLDescription"=>"", "Spatial/HorizontalSpatialDomain/Geometry/CoordinateSystem"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point0/PointLongitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point0/PointLatitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point1/PointLongitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point1/PointLatitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point2/PointLongitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point2/PointLatitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point3/PointLongitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point3/PointLatitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point4/PointLongitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point4/PointLatitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point5/PointLongitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point5/PointLatitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point6/PointLongitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point6/PointLatitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point7/PointLongitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point7/PointLatitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point8/PointLongitude"=>"", "Spatial/HorizontalSpatialDomain/Geometry/GPolygon/Boundary/Point8/PointLatitude"=>"", "Spatial/GranuleSpatialRepresentation"=>"", "DataFormat"=>"", "Spatial/HorizontalSpatialDomain/Geometry/BoundingRectangle/WestBoundingCoordinate"=>"", "Spatial/HorizontalSpatialDomain/Geometry/BoundingRectangle/NorthBoundingCoordinate"=>"", "Spatial/HorizontalSpatialDomain/Geometry/BoundingRectangle/EastBoundingCoordinate"=>"", "Spatial/HorizontalSpatialDomain/Geometry/BoundingRectangle/SouthBoundingCoordinate"=>""}
      (Record.find_by id: 1).get_colors.update_color_counts(new_color_hash)
      assert_equal(3, (Record.find_by id: 1).get_colors.blue_count)
      assert_equal(1, (Record.find_by id: 1).get_colors.green_count)
      assert_equal(2, (Record.find_by id: 1).get_colors.yellow_count)
      assert_equal(1, (Record.find_by id: 1).get_colors.red_count)
    end
  end

  describe "total_reviewed" do
    it "returns the total number of elements reviews" do
      assert_equal(28, (Record.find_by id: 1).get_colors.total_reviewed)
    end
  end
end